# Configuration for Cog ⚙️
# Reference: https://github.com/replicate/cog/blob/main/docs/yaml.md

build:
  # set to true if your model requires a GPU
  gpu: true
  cuda: "11.8"

  # a list of ubuntu apt packages to install
  system_packages:
    - "aria2"
    - "libgl1-mesa-glx"
    - "libglib2.0-0"
    - "nvidia-cudnn"
    # - "libcudnn8"
    # - "libcudnn8-dev"

  # python version in the form '3.11' or '3.11.4'
  python_version: "3.9.18"

  # a list of packages in the format <package-name>==<version>
  python_packages:
    - "absl-py==2.0.0"
    - "aiofiles==23.2.1"
    - "aiohttp==3.8.6"
    - "aiosignal==1.3.1"
    - "altair==5.1.2"
    - "annotated-types==0.6.0"
    - "antlr4-python3-runtime==4.8"
    - "anyio==3.7.1"
    - "asttokens==2.4.0"
    - "async-timeout==4.0.3"
    - "attrs==23.1.0"
    - "audioread==3.0.1"
    - "av==11.0.0"
    - "backcall==0.2.0"
    - "bitarray==2.8.2"
    - "Brotli==1.1.0"
    - "cachetools==5.3.2"
    - "certifi==2023.7.22"
    - "cffi==1.16.0"
    - "charset-normalizer==3.3.2"
    - "click==8.1.7"
    - "cloudpickle==3.0.0"
    - "cmake==3.27.7"
    - "cog==0.8.6"
    - "colorama==0.4.6"
    - "coloredlogs==15.0.1"
    - "comm==0.1.4"
    - "contourpy==1.2.0"
    - "cycler==0.12.1"
    - "Cython==3.0.5"
    - "debugpy==1.8.0"
    - "decorator==5.1.1"
    - "deemix==3.6.6"
    - "deezer-py==1.3.7"
    - "demucs==4.0.1"
    - "dora-search==0.1.12"
    - "einops==0.7.0"
    - "exceptiongroup==1.1.3"
    - "executing==1.2.0"
    - "fairseq==0.12.2"
    - "faiss-cpu==1.7.3"
    - "fastapi==0.88.0"
    - "ffmpeg==1.4"
    - "ffmpeg-python==0.2.0"
    - "ffmpy==0.3.1"
    - "filelock==3.13.1"
    - "flatbuffers==23.5.26"
    - "fonttools==4.44.0"
    - "frozenlist==1.4.0"
    - "fsspec==2023.10.0"
    - "future==0.18.3"
    - "google-auth==2.23.4"
    - "google-auth-oauthlib==1.1.0"
    - "gradio==3.34.0"
    - "gradio_client==0.7.0"
    - "grpcio==1.59.3"
    - "h11==0.14.0"
    - "httpcore==1.0.1"
    - "httptools==0.6.1"
    - "httpx==0.25.1"
    - "huggingface-hub==0.19.0"
    - "humanfriendly==10.0"
    - "hydra-core==1.0.7"
    - "idna==3.4"
    - "importlib-metadata==6.8.0"
    - "importlib-resources==6.1.1"
    - "ipykernel==6.25.2"
    - "ipython==8.16.0"
    - "jedi==0.19.0"
    - "Jinja2==3.1.2"
    - "joblib==1.3.2"
    - "json5==0.9.14"
    - "jsonschema==4.19.2"
    - "jsonschema-specifications==2023.7.1"
    - "julius==0.2.7"
    - "jupyter_client==8.3.1"
    - "jupyter_core==5.3.2"
    - "kiwisolver==1.4.5"
    - "lameenc==1.6.3"
    - "lib==4.0.0"
    - "librosa==0.9.1"
    - "linkify-it-py==2.0.2"
    - "lit==17.0.4"
    - "llvmlite==0.39.0"
    - "lxml==4.9.3"
    - "Markdown==3.5.1"
    - "markdown-it-py==2.2.0"
    - "MarkupSafe==2.1.3"
    - "matplotlib==3.8.1"
    - "matplotlib-inline==0.1.6"
    - "mdit-py-plugins==0.3.3"
    - "mdurl==0.1.2"
    - "mpmath==1.3.0"
    - "multidict==6.0.4"
    - "mutagen==1.47.0"
    - "nest-asyncio==1.5.8"
    - "networkx==3.2.1"
    - "numba==0.56.4"
    - "numpy==1.23.5"
    # - "nvidia-cublas-cu12==12.1.3.1"
    # - "nvidia-cuda-cupti-cu12==12.1.105"
    # - "nvidia-cuda-nvrtc-cu12==12.1.105"
    # - "nvidia-cuda-runtime-cu12==12.1.105"
    # - "nvidia-cudnn-cu12==8.9.2.26"
    # - "nvidia-cufft-cu12==11.0.2.54"
    # - "nvidia-curand-cu12==10.3.2.106"
    # - "nvidia-cusolver-cu12==11.4.5.107"
    # - "nvidia-cusparse-cu12==12.1.0.106"
    # - "nvidia-nccl-cu12==2.18.1"
    # - "nvidia-nvjitlink-cu12==12.3.101"
    # - "nvidia-nvtx-cu12==12.1.105"
    - "oauthlib==3.2.2"
    - "omegaconf==2.0.6"
    - "onnxruntime-gpu==1.16.2"
    - "openunmix==1.2.1"
    - "orjson==3.9.10"
    - "packaging==23.1"
    - "pandas==2.1.2"
    - "parso==0.8.3"
    - "pedalboard==0.7.7"
    - "pexpect==4.8.0"
    - "pickleshare==0.7.5"
    - "Pillow==10.1.0"
    - "pip==23.3"
    - "platformdirs==3.10.0"
    - "pooch==1.8.0"
    - "portalocker==2.8.2"
    - "praat-parselmouth==0.4.3"
    - "prompt-toolkit==3.0.39"
    - "protobuf==4.23.4"
    - "psutil==5.9.5"
    - "ptyprocess==0.7.0"
    - "pure-eval==0.2.2"
    - "pyasn1==0.5.0"
    - "pyasn1-modules==0.3.0"
    - "pycparser==2.21"
    - "pycryptodomex==3.19.0"
    - "pydantic==1.10.13"
    - "pydantic_core==2.10.1"
    - "pydub==0.25.1"
    - "Pygments==2.16.1"
    - "pyparsing==3.1.1"
    - "python-dateutil==2.8.2"
    - "python-dotenv==1.0.0"
    - "python-multipart==0.0.6"
    - "pytz==2023.3.post1"
    - "pyworld==0.3.2"
    - "PyYAML==6.0.1"
    - "pyzmq==25.1.1"
    - "referencing==0.30.2"
    - "regex==2023.10.3"
    - "requests==2.31.0"
    - "requests-oauthlib==1.3.1"
    - "resampy==0.4.2"
    - "retrying==1.3.4"
    - "rpds-py==0.12.0"
    - "rsa==4.9"
    - "sacrebleu==2.3.2"
    - "scikit-learn==1.3.2"
    - "scipy==1.11.1"
    - "semantic-version==2.10.0"
    - "setuptools==68.0.0"
    - "six==1.16.0"
    - "sniffio==1.3.0"
    - "soundfile==0.12.1"
    - "sox==1.4.1"
    - "stack-data==0.6.2"
    - "starlette==0.22.0"
    - "structlog==23.2.0"
    - "submitit==1.5.1"
    - "sympy==1.12"
    - "tabulate==0.9.0"
    - "tensorboard==2.15.1"
    - "tensorboard-data-server==0.7.2"
    - "tensorboardX==2.6.2.2"
    - "threadpoolctl==3.2.0"
    - "toolz==0.12.0"
    - "torch==2.1.1"
    - "torchaudio==2.1.1"
    - "torchcrepe==0.0.20"
    - "torchvision==0.16.1"
    - "tornado==6.3.3"
    - "tqdm==4.65.0"
    - "traitlets==5.10.1"
    - "treetable==0.2.5"
    - "triton==2.1.0"
    - "typing_extensions==4.8.0"
    - "tzdata==2023.3"
    - "uc-micro-py==1.0.2"
    - "urllib3==2.0.7"
    - "uvicorn==0.24.0.post1"
    - "uvloop==0.19.0"
    - "watchfiles==0.21.0"
    - "wcwidth==0.2.7"
    - "websockets==11.0.3"
    - "Werkzeug==3.0.1"
    - "wheel==0.41.2"
    - "yarl==1.9.2"
    - "yt-dlp==2023.7.6"
    - "zipp==3.17.0"

  # commands run after the environment is setup
  run:
    - pip install --upgrade pip
    - apt-get update && apt-get install -y ffmpeg
    - pip install imageio[ffmpeg]
    - pip install torch==2.1.1+cu118 torchvision==0.16.1+cu118 torchaudio==2.1.1+cu118 -f https://download.pytorch.org/whl/torch_stable.html
    # - apt-get install libcudnn8
    # - apt-get install libcudnn8-dev

# predict.py defines how predictions are run on your model
predict: "predict.py:Predictor"
